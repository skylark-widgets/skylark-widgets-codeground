/**
 * skylark-ui-coder - The skylark coder widget
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylarkui/skylark-ui-coder/
 * @license MIT
 */
define(["../../Coder"],function(t){"use strict";function r(t,r,e){for(var n=e.paragraphStart||t.getHelper(r,"paragraphStart"),o=r.line,a=t.firstLine();o>a;--o){var i=t.getLine(o);if(n&&n.test(i))break;if(!/\S/.test(i)){++o;break}}for(var f=e.paragraphEnd||t.getHelper(r,"paragraphEnd"),l=r.line+1,h=t.lastLine();l<=h;++l){var i=t.getLine(l);if(f&&f.test(i)){++l;break}if(!/\S/.test(i))break}return{from:o,to:l}}function e(t,r,e,n){for(var o=r;o<t.length&&" "==t.charAt(o);)o++;for(;o>0&&!e.test(t.slice(o-1,o+1));--o);for(var a=!0;;a=!1){var i=o;if(n)for(;" "==t.charAt(i-1);)--i;if(0!=i||!a)return{from:i,to:o};o=r}}function n(r,n,a,i){n=r.clipPos(n),a=r.clipPos(a);var f=i.column||80,l=i.wrapOn||/\s\S|-[^\.\d]/,h=i.killTrailingSpace!==!1,s=[],g="",c=n.line,p=r.getRange(n,a,!1);if(!p.length)return null;for(var u=p[0].match(/^[ \t]*/)[0],m=0;m<p.length;++m){var v=p[m],d=g.length,x=0;g&&v&&!l.test(g.charAt(g.length-1)+v.charAt(0))&&(g+=" ",x=1);var S="";if(m&&(S=v.match(/^\s*/)[0],v=v.slice(S.length)),g+=v,m){var E=g.length>f&&u==S&&e(g,f,l,h);E&&E.from==d&&E.to==d+x?(g=u+v,++c):s.push({text:[x?" ":""],from:o(c,d),to:o(c+1,S.length)})}for(;g.length>f;){var L=e(g,f,l,h);s.push({text:["",u],from:o(c,L.from),to:o(c,L.to)}),g=u+g.slice(L.to),++c}}return s.length&&r.operation(function(){for(var e=0;e<s.length;++e){var n=s[e];(n.text||t.cmpPos(n.from,n.to))&&r.replaceRange(n.text,n.from,n.to)}}),s.length?{from:s[0].from,to:t.changeEnd(s[s.length-1])}:null}var o=t.Pos;t.defineExtension("wrapParagraph",function(t,e){e=e||{},t||(t=this.getCursor());var a=r(this,t,e);return n(this,o(a.from,0),o(a.to-1),e)}),t.commands.wrapLines=function(t){t.operation(function(){for(var e=t.listSelections(),a=t.lastLine()+1,i=e.length-1;i>=0;i--){var f,l=e[i];if(l.empty()){var h=r(t,l.head,{});f={from:o(h.from,0),to:o(h.to-1)}}else f={from:l.from(),to:l.to()};f.to.line>=a||(a=f.from.line,n(t,f.from,f.to,{}))}})},t.defineExtension("wrapRange",function(t,r,e){return n(this,t,r,e||{})}),t.defineExtension("wrapParagraphsInRange",function(t,e,a){a=a||{};for(var i=this,f=[],l=t.line;l<=e.line;){var h=r(i,o(l,0),a);f.push(h),l=h.to}var s=!1;return f.length&&i.operation(function(){for(var t=f.length-1;t>=0;--t)s=s||n(i,o(f[t].from,0),o(f[t].to-1),a)}),s})});
//# sourceMappingURL=../../sourcemaps/addon/wrap/hardwrap.js.map
