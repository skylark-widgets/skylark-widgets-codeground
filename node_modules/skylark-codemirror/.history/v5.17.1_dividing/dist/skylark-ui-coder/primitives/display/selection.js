/**
 * skylark-ui-coder - The skylark coder widget
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylarkui/skylark-ui-coder/
 * @license MIT
 */
define(["../CoderCtor"],function(t){t.partial({updateSelection:function(){var t=this;t.display.input.showSelection(t.display.input.prepareSelection())},prepareSelection:function(t){for(var e=this,o=e.doc,i={},r=i.cursors=document.createDocumentFragment(),n=i.selection=document.createDocumentFragment(),l=0;l<o.sel.ranges.length;l++)if(t!==!1||l!=o.sel.primIndex){var s=o.sel.ranges[l];if(!(s.from().line>=e.display.viewTo||s.to().line<e.display.viewFrom)){var a=s.empty();(a||e.options.showCursorWhenSelecting)&&e.drawSelectionCursor(s.head,r),a||e.drawSelectionRange(s,n)}}return i},drawSelectionCursor:function(t,e){var o=this,i=o.cursorCoords(t,"div",null,null,!o.options.singleCursorHeightPerLine),r=e.appendChild(elt("div"," ","CodeMirror-cursor"));if(r.style.left=i.left+"px",r.style.top=i.top+"px",r.style.height=Math.max(0,i.bottom-i.top)*o.options.cursorHeight+"px",i.other){var n=e.appendChild(elt("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));n.style.display="",n.style.left=i.other.left+"px",n.style.top=i.other.top+"px",n.style.height=.85*(i.other.bottom-i.other.top)+"px"}},drawSelectionRange:function(t,e){function o(t,e,o,i){e<0&&(e=0),e=Math.round(e),i=Math.round(i),s.appendChild(elt("div",null,"CodeMirror-selected","position: absolute; left: "+t+"px; top: "+e+"px; width: "+(null==o?d-t:o)+"px; height: "+(i-e)+"px"))}function i(t,e,i){function n(e,o){return charCoords(r,Pos(t,e),"div",u,o)}var s,a,u=getLine(l,t),c=u.text.length;return iterateBidiSections(getOrder(u),e||0,null==i?c:i,function(t,r,l){var u,h,f,m=n(t,"left");if(t==r)u=m,h=f=m.left;else{if(u=n(r-1,"right"),"rtl"==l){var v=m;m=u,u=v}h=m.left,f=u.right}null==e&&0==t&&(h=p),u.top-m.top>3&&(o(h,m.top,null,m.bottom),h=p,m.bottom<u.top&&o(h,m.bottom,null,u.top)),null==i&&r==c&&(f=d),(!s||m.top<s.top||m.top==s.top&&m.left<s.left)&&(s=m),(!a||u.bottom>a.bottom||u.bottom==a.bottom&&u.right>a.right)&&(a=u),h<p+1&&(h=p),o(h,u.top,f-h,u.bottom)}),{start:s,end:a}}var r=this,n=r.display,l=r.doc,s=document.createDocumentFragment(),a=paddingH(r.display),p=a.left,d=Math.max(n.sizerWidth,r.displayWidth()-n.sizer.offsetLeft)-a.right,u=t.from(),c=t.to();if(u.line==c.line)i(u.line,u.ch,c.ch);else{var h=getLine(l,u.line),f=getLine(l,c.line),m=visualLine(h)==visualLine(f),v=i(u.line,u.ch,m?h.text.length+1:null).end,g=i(c.line,m?0:null,c.ch).start;m&&(v.top<g.top-2?(o(v.right,v.top,null,v.bottom),o(p,g.top,g.left,g.bottom)):o(v.right,v.top,g.left-v.right,v.bottom)),v.bottom<g.top&&o(p,v.bottom,null,g.top)}e.appendChild(s)},restartBlink:function(){var t=this;if(t.state.focused){var e=t.display;clearInterval(e.blinker);var o=!0;e.cursorDiv.style.visibility="",t.options.cursorBlinkRate>0?e.blinker=setInterval(function(){e.cursorDiv.style.visibility=(o=!o)?"":"hidden"},t.options.cursorBlinkRate):t.options.cursorBlinkRate<0&&(e.cursorDiv.style.visibility="hidden")}}})});
//# sourceMappingURL=../../sourcemaps/primitives/display/selection.js.map
