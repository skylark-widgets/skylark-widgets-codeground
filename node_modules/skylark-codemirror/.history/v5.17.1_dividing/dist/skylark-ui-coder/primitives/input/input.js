/**
 * skylark-ui-coder - The skylark coder widget
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylarkui/skylark-ui-coder/
 * @license MIT
 */
define(["../CoderCtor"],function(e){var t=null;e.partial({applyTextInput:function(e,n,i,r){var a=this,l=a.doc;a.display.shift=!1,i||(i=l.sel);var o=a.state.pasteIncoming||"paste"==r,s=l.splitLines(e),d=null;if(o&&i.ranges.length>1)if(t&&t.text.join("\n")==e){if(i.ranges.length%t.text.length==0){d=[];for(var c=0;c<t.text.length;c++)d.push(l.splitLines(t.text[c]))}}else s.length==i.ranges.length&&(d=map(s,function(e){return[e]}));for(var c=i.ranges.length-1;c>=0;c--){var p=i.ranges[c],u=p.from(),h=p.to();p.empty()&&(n&&n>0?u=Pos(u.line,u.ch-n):a.state.overwrite&&!o?h=Pos(h.line,Math.min(getLine(l,h.line).text.length,h.ch+lst(s).length)):t&&t.lineWise&&t.text.join("\n")==e&&(u=h=Pos(u.line,0)));var f=a.curOp.updateInput,g={from:u,to:h,text:d?d[c%d.length]:s,origin:r||(o?"paste":a.state.cutIncoming?"cut":"+input")};makeChange(a.doc,g),a.signalLater("inputRead",a,g)}e&&!o&&a.triggerElectric(e),a.ensureCursorVisible(),a.curOp.updateInput=f,a.curOp.typing=!0,a.state.pasteIncoming=a.state.cutIncoming=!1},handlePaste:function(e){var t=this,n=e.clipboardData&&e.clipboardData.getData("text/plain");if(n)return e.preventDefault(),t.isReadOnly()||t.options.disableInput||t.runInOp(function(){t.applyTextInput(n,0,null,"paste")}),!0},triggerElectric:function(e){var t=this;if(t.options.electricChars&&t.options.smartIndent)for(var n=t.doc.sel,i=n.ranges.length-1;i>=0;i--){var r=n.ranges[i];if(!(r.head.ch>100||i&&n.ranges[i-1].head.line==r.head.line)){var a=t.getModeAt(r.head),l=!1;if(a.electricChars){for(var o=0;o<a.electricChars.length;o++)if(e.indexOf(a.electricChars.charAt(o))>-1){l=t.indentLine(r.head.line,"smart");break}}else a.electricInput&&a.electricInput.test(t.doc.getLine(r.head.line).text.slice(0,r.head.ch))&&(l=t.indentLine(r.head.line,"smart"));l&&t.signalLater("electricInput",t,r.head.line)}}},copyableRanges:function(){for(var e=this,t=[],n=[],i=0;i<e.doc.sel.ranges.length;i++){var r=e.doc.sel.ranges[i].head.line,a={anchor:Pos(r,0),head:Pos(r+1,0)};n.push(a),t.push(e.getRange(a.anchor,a.head))}return{text:t,ranges:n}},posToDOM:function(e){var t=this,n=t.findViewForLine(e.line);if(!n||n.hidden)return null;var i=t.doc.getLine(e.line),r=mapFromLineView(n,i,e.line),a=getOrder(i),l="left";if(a){var o=getBidiPartAt(a,e.ch);l=o%2?"right":"left"}var s=nodeAndOffsetInLineMap(r.map,e.ch,l);return s.offset="right"==s.collapse?s.end:s.start,s},domToPos:function(e,t){var n,i=this;if(e==i.display.lineDiv){if(n=i.display.lineDiv.childNodes[t],!n)return badPos(i.clipPos(Pos(i.display.viewTo-1)),!0);e=null,t=0}else for(n=e;;n=n.parentNode){if(!n||n==i.display.lineDiv)return null;if(n.parentNode&&n.parentNode==i.display.lineDiv)break}for(var r=0;r<i.display.view.length;r++){var a=i.display.view[r];if(a.node==n)return a.locateNodeInLineView(e,t)}},domTextBetween:function(e,t,n,i){function r(e){return function(t){return t.id==e}}function a(e){if(1==e.nodeType){var t=e.getAttribute("cm-text");if(null!=t)return""==t&&(t=e.textContent.replace(/\u200b/g,"")),void(o+=t);var c,p=e.getAttribute("cm-marker");if(p){var u=l.findMarks(Pos(n,0),Pos(i+1,0),r(+p));return void(u.length&&(c=u[0].find())&&(o+=getBetween(l.doc,c.from,c.to).join(d)))}if("false"==e.getAttribute("contenteditable"))return;for(var h=0;h<e.childNodes.length;h++)a(e.childNodes[h]);/^(pre|div|p)$/i.test(e.nodeName)&&(s=!0)}else if(3==e.nodeType){var f=e.nodeValue;if(!f)return;s&&(o+=d,s=!1),o+=f}}for(var l=this,o="",s=!1,d=l.doc.lineSeparator();a(e),e!=t;)e=e.nextSibling;return o}})});
//# sourceMappingURL=../../sourcemaps/primitives/input/input.js.map
