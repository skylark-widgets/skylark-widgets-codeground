/**
 * skylark-ui-coder - The skylark coder widget
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylarkui/skylark-ui-coder/
 * @license MIT
 */
define(["../CoderCtor"],function(t){function e(t,e,s,n){for(var o=0;o<10;o++){n&&(n[0]=CodeMirror.innerMode(t,s).mode);var r=t.token(e,s);if(e.pos>e.start)return r}throw new Error("Mode "+t.name+" failed to advance stream.")}function s(t,s,n,o,r,a,i){var l=n.flattenSpans;null==l&&(l=t.options.flattenSpans);var f,c=0,d=null,u=new StringStream(s,t.options.tabSize),p=t.options.addModeClass&&[null];for(""==s&&extractLineClasses(callBlankLine(n,o),a);!u.eol();){if(u.pos>t.options.maxHighlightLength?(l=!1,i&&processLine(t,s,o,u.pos),u.pos=s.length,f=null):f=extractLineClasses(e(n,u,o,p),a),p){var h=p[0].name;h&&(f="m-"+(f?h+" "+f:h))}if(!l||d!=f){for(;c<u.start;)c=Math.min(u.start,c+5e4),r(c,d);d=f}u.start=u.pos}for(;c<u.pos;){var v=Math.min(u.pos,c+5e4);r(v,d),c=v}}t.partial({findStartLine:function(t,e){for(var s,n,o=this,r=o.doc,a=e?-1:t-(o.doc.mode.innerMode?1e3:100),i=t;i>a;--i){if(i<=r.first)return r.first;var l=getLine(r,i-1);if(l.stateAfter&&(!e||i<=r.frontier))return i;var f=countColumn(l.text,null,o.options.tabSize);(null==n||s>f)&&(n=i-1,s=f)}return n},highlightLine:function(t,e,n){var o=this,r=[o.state.modeGen],a={};s(o,t.text,o.doc.mode,e,function(t,e){r.push(t,e)},a,n);for(var i=0;i<o.state.overlays.length;++i){var l=o.state.overlays[i],f=1,c=0;s(o,t.text,l.mode,!0,function(t,e){for(var s=f;c<t;){var n=r[f];n>t&&r.splice(f,1,t,r[f+1],n),f+=2,c=Math.min(t,n)}if(e)if(l.opaque)r.splice(s,f-s,t,"cm-overlay "+e),f=s+2;else for(;s<f;s+=2){var o=r[s+1];r[s+1]=(o?o+" ":"")+"cm-overlay "+e}},a)}return{styles:r,classes:a.bgClass||a.textClass?a:null}},getLineStyles:function(t,e){var s=this;if(!t.styles||t.styles[0]!=s.state.modeGen){var n=s.getStateBefore(lineNo(t)),o=s.highlightLine(t,t.text.length>s.options.maxHighlightLength?copyState(s.doc.mode,n):n);t.stateAfter=n,t.styles=o.styles,o.classes?t.styleClasses=o.classes:t.styleClasses&&(t.styleClasses=null),e===s.doc.frontier&&s.doc.frontier++}return t.styles},processLine:function(t,s,n){var o=this,r=o.doc.mode,a=new StringStream(t,o.options.tabSize);for(a.start=a.pos=n||0,""==t&&callBlankLine(r,s);!a.eol();)e(r,a,s),a.start=a.pos}})});
//# sourceMappingURL=../../sourcemaps/primitives/line/highlight.js.map
