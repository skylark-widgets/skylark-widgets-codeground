{"version":3,"sources":["Coder.js"],"names":["define","CoderCtor","getStateBefore","cm","n","precise","doc","display","mode","startState","pos","findStartLine","state","first","getLine","stateAfter","copyState","iter","line","processLine","text","save","viewFrom","viewTo","frontier","registerEventHandlers","finishTouch","d","activeTouch","touchFinished","setTimeout","prevTouch","end","Date","isMouseLikeTouchEvent","e","touches","length","touch","radiusX","radiusY","farAway","other","left","dx","dy","top","on","scroller","operation","onMouseDown","ie","ie_version","signalDOMEvent","posFromMouse","clickInGutter","eventInWidget","e_preventDefault","word","findWordAt","extendSelection","anchor","head","captureRightClick","onContextMenu","clearTimeout","now","start","moved","prev","pageX","pageY","range","coordsChar","Range","Pos","clipPos","setSelection","focus","clientHeight","setScrollTop","scrollTop","setScrollLeft","scrollLeft","signal","onScrollWheel","wrapper","dragFunctions","enter","e_stop","over","onDragOver","onDragStart","drop","onDrop","leave","clearDragCursor","inp","input","getField","onKeyUp","call","onKeyDown","onKeyPress","bind","onFocus","onBlur","findPosH","dir","unit","visually","findNextLine","l","size","lineObj","moveOnce","boundToLine","next","moveVisually","moveLogically","ch","lineRight","lineLeft","origDir","sawType","group","helper","getHelper","cur","charAt","type","isWordChar","test","result","skipAtomic","cmp","hitSide","findPosV","y","x","pageSize","Math","min","window","innerHeight","document","documentElement","textHeight","bottom","target","outside","height","partial","_construct","place","options","this","CodeMirror","copyObj","defaults","setGuttersForLineNumbers","value","Doc","lineSeparator","inputStyles","inputStyle","Display","updateGutters","themeChanged","lineWrapping","className","autofocus","mobile","initScrollbars","keyMaps","overlays","modeGen","overwrite","delayingBlurEvent","focused","suppressEdits","pasteIncoming","cutIncoming","selectingText","draggingText","highlight","Delayed","keySeq","specialChars","reset","ensureGlobalHandlers","startOperation","curOp","forceUpdate","attachDoc","hasFocus","opt","optionHandlers","hasOwnProperty","Init","maybeUpdateLineNumberWidth","finishInit","i","initHooks","endOperation","webkit","getComputedStyle","lineDiv","textRendering","style","textarea","TextareaInput","contenteditable","ContentEditableInput","prototype","constructor","setOption","option","old","getOption","getDoc","addKeyMap","map","getKeyMap","removeKeyMap","maps","name","splice","addOverlay","methodOp","spec","token","getMode","Error","push","modeSpec","opaque","regChange","removeOverlay","indentLine","aggressive","smartIndent","isLine","indentSelection","how","ranges","sel","empty","primIndex","ensureCursorVisible","from","to","max","lastLine","j","newRanges","replaceOneSelection","sel_dontScroll","getTokenAt","takeToken","getLineTokens","getTokenTypeAt","styles","getLineStyles","before","after","mid","cut","indexOf","slice","getModeAt","innerMode","getHelpers","found","helpers","help","val","helperType","_global","pred","getStateAfter","clipLine","cursorCoords","primary","charCoords","coords","fromCoordSystem","lineAtHeight","viewOffset","heightAtLine","last","intoCoordSystem","defaultTextHeight","defaultCharWidth","charWidth","setGutterMarker","gutterID","changeLine","markers","gutterMarkers","isEmpty","clearGutter","regLineChange","lineInfo","lineNo","handle","textClass","bgClass","wrapClass","widgets","getViewport","addWidget","node","scroll","vert","horiz","position","setAttribute","setUneditable","sizer","appendChild","vspace","hspace","clientWidth","lineSpace","offsetHeight","offsetWidth","right","scrollIntoView","triggerOnKeyDown","triggerOnKeyPress","triggerOnKeyUp","execCommand","cmd","commands","triggerElectric","amount","moveH","extendSelectionsBy","shift","extend","rtlMoveVisually","sel_move","deleteH","somethingSelected","replaceSelection","deleteNearSelection","goalColumn","moveV","goals","collapse","headPos","addToScrollPos","xRel","startChar","check","toggleOverwrite","addClass","cursorDiv","rmClass","activeElt","isReadOnly","readOnly","cantEdit","scrollTo","resolveScrollToPos","getScrollInfo","scrollHeight","scrollGap","barHeight","width","scrollWidth","barWidth","displayHeight","displayWidth","margin","cursorScrollMargin","scrollToPos","sPos","calculateScrollPos","setSize","interpret","String","clearLineMeasurementCache","noHScroll","f","runInOp","refresh","oldHeight","cachedTextHeight","clearCaches","updateGutterSpace","abs","estimateLineHeights","swapDoc","forceScroll","signalLater","getInputField","getWrapperElement","getScrollerElement","getGutterElement","gutters","eventMixin","version"],"mappings":"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","file":"../Coder.js","sourcesContent":["define([\n  \"./primitives/CoderCtor\",\n  \"./primitives/display/focus\"\n], function(CoderCtor) {\n\n  // Original : CodeMirror 5.17.1\n  \"use strict\";\n\n  // util/browser.js\n\n\n  // EDITOR CONSTRUCTOR\n  CoderCtor.partial({\n    _construct : function (place, options) {\n      if (!(this instanceof CodeMirror)) return new CodeMirror(place, options);\n\n      this.options = options = options ? copyObj(options) : {};\n      // Determine effective options based on given values and defaults.\n      copyObj(defaults, options, false);\n      setGuttersForLineNumbers(options);\n\n      var doc = options.value;\n      if (typeof doc == \"string\") doc = new Doc(doc, options.mode, null, options.lineSeparator);\n      this.doc = doc;\n\n      var input = new CodeMirror.inputStyles[options.inputStyle](this);\n      var display = this.display = new Display(place, doc, input);\n      display.wrapper.CodeMirror = this;\n      updateGutters(this);\n      themeChanged(this);\n      if (options.lineWrapping)\n        this.display.wrapper.className += \" CodeMirror-wrap\";\n      if (options.autofocus && !mobile) display.input.focus();\n      initScrollbars(this);\n\n      this.state = {\n        keyMaps: [],  // stores maps added by addKeyMap\n        overlays: [], // highlighting overlays, as added by addOverlay\n        modeGen: 0,   // bumped when mode/overlay changes, used to invalidate highlighting info\n        overwrite: false,\n        delayingBlurEvent: false,\n        focused: false,\n        suppressEdits: false, // used to disable editing during key handlers when in readOnly mode\n        pasteIncoming: false, cutIncoming: false, // help recognize paste/cut edits in input.poll\n        selectingText: false,\n        draggingText: false,\n        highlight: new Delayed(), // stores highlight worker timeout\n        keySeq: null,  // Unfinished key sequence\n        specialChars: null\n      };\n\n      var cm = this;\n\n      // Override magic textarea content restore that IE sometimes does\n      // on our hidden textarea on reload\n      if (ie && ie_version < 11) setTimeout(function() { cm.display.input.reset(true); }, 20);\n\n      registerEventHandlers(this);\n      ensureGlobalHandlers();\n\n      startOperation(this);\n      this.curOp.forceUpdate = true;\n      attachDoc(this, doc);\n\n      if ((options.autofocus && !mobile) || cm.hasFocus())\n        setTimeout(bind(onFocus, this), 20);\n      else\n        onBlur(this);\n\n      for (var opt in optionHandlers) if (optionHandlers.hasOwnProperty(opt))\n        optionHandlers[opt](this, options[opt], Init);\n      maybeUpdateLineNumberWidth(this);\n      if (options.finishInit) options.finishInit(this);\n      for (var i = 0; i < initHooks.length; ++i) initHooks[i](this);\n      endOperation(this);\n      // Suppress optimizelegibility in Webkit, since it breaks text\n      // measuring on line wrapping boundaries.\n      if (webkit && options.lineWrapping &&\n          getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\")\n        display.lineDiv.style.textRendering = \"auto\";\n    },\n\n  });\n\n  // display/Display.js\n\n  // STATE UPDATES\n\n  // display/scrollbars.js\n\n  // display/line_numbers.js\n\n  // display/update_display.js \n \n  // display/update_lines.js\n\n\n  // display/update_line.js\n\n  // line/pos.js\n  \n  // display/focus.js\n   \n  // input/input.js\n\n  // input/Textaeainout.js\n\n  // input/ContentEditableInput.js\n\n\n  CodeMirror.inputStyles = {\"textarea\": TextareaInput, \"contenteditable\": ContentEditableInput};\n\n  // SELECTION / CURSOR\n\n  // Selection/Range -> skylark-utils-text\n\n  // skylark-utils-text/selection_updates.js\n\n  // display/highlight_worker.js\n\n  // line/highlight.js\n\n\n  function getStateBefore(cm, n, precise) {\n    var doc = cm.doc, display = cm.display;\n    if (!doc.mode.startState) return true;\n    var pos = findStartLine(cm, n, precise), state = pos > doc.first && getLine(doc, pos-1).stateAfter;\n    if (!state) state = startState(doc.mode);\n    else state = copyState(doc.mode, state);\n    doc.iter(pos, n, function(line) {\n      processLine(cm, line.text, state);\n      var save = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo;\n      line.stateAfter = save ? copyState(doc.mode, state) : null;\n      ++pos;\n    });\n    if (precise) doc.frontier = pos;\n    return state;\n  }\n\n  // position_measurement.js\n\n  // util/operation_group.js\n\n  // line/line_data.js\n\n  // dislpay/view_tracking .js\n\n\n  // EVENT HANDLERS\n\n  // Attach the necessary event handlers when initializing the editor\n  function registerEventHandlers(cm) {\n    var d = cm.display;\n    on(d.scroller, \"mousedown\", operation(cm, onMouseDown));\n    // Older IE's will not fire a second mousedown for a double click\n    if (ie && ie_version < 11)\n      on(d.scroller, \"dblclick\", operation(cm, function(e) {\n        if (signalDOMEvent(cm, e)) return;\n        var pos = posFromMouse(cm, e);\n        if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) return;\n        e_preventDefault(e);\n        var word = cm.findWordAt(pos);\n        extendSelection(cm.doc, word.anchor, word.head);\n      }));\n    else\n      on(d.scroller, \"dblclick\", function(e) { signalDOMEvent(cm, e) || e_preventDefault(e); });\n    // Some browsers fire contextmenu *after* opening the menu, at\n    // which point we can't mess with it anymore. Context menu is\n    // handled in onMouseDown for these browsers.\n    if (!captureRightClick) on(d.scroller, \"contextmenu\", function(e) {onContextMenu(cm, e);});\n\n    // Used to suppress mouse event handling when a touch happens\n    var touchFinished, prevTouch = {end: 0};\n    function finishTouch() {\n      if (d.activeTouch) {\n        touchFinished = setTimeout(function() {d.activeTouch = null;}, 1000);\n        prevTouch = d.activeTouch;\n        prevTouch.end = +new Date;\n      }\n    };\n    function isMouseLikeTouchEvent(e) {\n      if (e.touches.length != 1) return false;\n      var touch = e.touches[0];\n      return touch.radiusX <= 1 && touch.radiusY <= 1;\n    }\n    function farAway(touch, other) {\n      if (other.left == null) return true;\n      var dx = other.left - touch.left, dy = other.top - touch.top;\n      return dx * dx + dy * dy > 20 * 20;\n    }\n    on(d.scroller, \"touchstart\", function(e) {\n      if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e)) {\n        clearTimeout(touchFinished);\n        var now = +new Date;\n        d.activeTouch = {start: now, moved: false,\n                         prev: now - prevTouch.end <= 300 ? prevTouch : null};\n        if (e.touches.length == 1) {\n          d.activeTouch.left = e.touches[0].pageX;\n          d.activeTouch.top = e.touches[0].pageY;\n        }\n      }\n    });\n    on(d.scroller, \"touchmove\", function() {\n      if (d.activeTouch) d.activeTouch.moved = true;\n    });\n    on(d.scroller, \"touchend\", function(e) {\n      var touch = d.activeTouch;\n      if (touch && !eventInWidget(d, e) && touch.left != null &&\n          !touch.moved && new Date - touch.start < 300) {\n        var pos = cm.coordsChar(d.activeTouch, \"page\"), range;\n        if (!touch.prev || farAway(touch, touch.prev)) // Single tap\n          range = new Range(pos, pos);\n        else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\n          range = cm.findWordAt(pos);\n        else // Triple tap\n          range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0)));\n        cm.setSelection(range.anchor, range.head);\n        cm.focus();\n        e_preventDefault(e);\n      }\n      finishTouch();\n    });\n    on(d.scroller, \"touchcancel\", finishTouch);\n\n    // Sync scrolling between fake scrollbars and real scrollable\n    // area, ensure viewport is updated when scrolling.\n    on(d.scroller, \"scroll\", function() {\n      if (d.scroller.clientHeight) {\n        setScrollTop(cm, d.scroller.scrollTop);\n        setScrollLeft(cm, d.scroller.scrollLeft, true);\n        signal(cm, \"scroll\", cm);\n      }\n    });\n\n    // Listen to wheel events in order to try and update the viewport on time.\n    on(d.scroller, \"mousewheel\", function(e){onScrollWheel(cm, e);});\n    on(d.scroller, \"DOMMouseScroll\", function(e){onScrollWheel(cm, e);});\n\n    // Prevent wrapper from ever scrolling\n    on(d.wrapper, \"scroll\", function() { d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\n\n    d.dragFunctions = {\n      enter: function(e) {if (!signalDOMEvent(cm, e)) e_stop(e);},\n      over: function(e) {if (!signalDOMEvent(cm, e)) { onDragOver(cm, e); e_stop(e); }},\n      start: function(e){onDragStart(cm, e);},\n      drop: operation(cm, onDrop),\n      leave: function(e) {if (!signalDOMEvent(cm, e)) { clearDragCursor(cm); }}\n    };\n\n    var inp = d.input.getField();\n    on(inp, \"keyup\", function(e) { onKeyUp.call(cm, e); });\n    on(inp, \"keydown\", operation(cm, onKeyDown));\n    on(inp, \"keypress\", operation(cm, onKeyPress));\n    on(inp, \"focus\", bind(onFocus, cm));\n    on(inp, \"blur\", bind(onBlur, cm));\n  }\n\n  // edit/options.js\n\n\n  // edit/mouse_events.js\n\n \n\n  // edit/drop_events.js\n\n  // display/scroll_events.js\n\n  // edit/key_events.js\n\n  // display/focus.js  \n\n  // edit/mouse_events.js\n\n  \n  // skylark-utils-text/change_measurement.js\n\n  // skylark-utils-text/changes\n\n  // display/scrolling.js\n\n\n  // API UTILITIES\n\n  // input/indent.js\n\n  // edit/deleteNearSelection.js\n\n\n\n  // Used for horizontal relative motion. Dir is -1 or 1 (left or\n  // right), unit can be \"char\", \"column\" (like char, but doesn't\n  // cross line boundaries), \"word\" (across next word), or \"group\" (to\n  // the start of next group of word or non-word-non-whitespace\n  // chars). The visually param controls whether, in right-to-left\n  // text, direction 1 means to move towards the next index in the\n  // string, or towards the character to the right of the current\n  // position. The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosH(doc, pos, dir, unit, visually) {\n    var line = pos.line, ch = pos.ch, origDir = dir;\n    var lineObj = getLine(doc, line);\n    function findNextLine() {\n      var l = line + dir;\n      if (l < doc.first || l >= doc.first + doc.size) return false\n      line = l;\n      return lineObj = getLine(doc, l);\n    }\n    function moveOnce(boundToLine) {\n      var next = (visually ? moveVisually : moveLogically)(lineObj, ch, dir, true);\n      if (next == null) {\n        if (!boundToLine && findNextLine()) {\n          if (visually) ch = (dir < 0 ? lineRight : lineLeft)(lineObj);\n          else ch = dir < 0 ? lineObj.text.length : 0;\n        } else return false\n      } else ch = next;\n      return true;\n    }\n\n    if (unit == \"char\") {\n      moveOnce()\n    } else if (unit == \"column\") {\n      moveOnce(true)\n    } else if (unit == \"word\" || unit == \"group\") {\n      var sawType = null, group = unit == \"group\";\n      var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n      for (var first = true;; first = false) {\n        if (dir < 0 && !moveOnce(!first)) break;\n        var cur = lineObj.text.charAt(ch) || \"\\n\";\n        var type = isWordChar(cur, helper) ? \"w\"\n          : group && cur == \"\\n\" ? \"n\"\n          : !group || /\\s/.test(cur) ? null\n          : \"p\";\n        if (group && !first && !type) type = \"s\";\n        if (sawType && sawType != type) {\n          if (dir < 0) {dir = 1; moveOnce();}\n          break;\n        }\n\n        if (type) sawType = type;\n        if (dir > 0 && !moveOnce(!first)) break;\n      }\n    }\n    var result = skipAtomic(doc, Pos(line, ch), pos, origDir, true);\n    if (!cmp(pos, result)) result.hitSide = true;\n    return result;\n  }\n\n  // For relative vertical movement. Dir may be -1 or 1. Unit can be\n  // \"page\" or \"line\". The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosV(cm, pos, dir, unit) {\n    var doc = cm.doc, x = pos.left, y;\n    if (unit == \"page\") {\n      var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n      y = pos.top + dir * (pageSize - (dir < 0 ? 1.5 : .5) * textHeight(cm.display));\n    } else if (unit == \"line\") {\n      y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n    }\n    for (;;) {\n      var target = coordsChar(cm, x, y);\n      if (!target.outside) break;\n      if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break; }\n      y += dir * 5;\n    }\n    return target;\n  }\n\n  // EDITOR METHODS\n\n  // The publicly visible API. Note that methodOp(f) means\n  // 'wrap f in an operation, performed on its `this` parameter'.\n\n  // This is not the complete set of editor methods. Most of the\n  // methods defined on the Doc type are also injected into\n  // CodeMirror.prototype, for backwards compatibility and\n  // convenience.\n\n  CodeMirror.prototype = {\n    constructor: CodeMirror,\n    focus: function(){window.focus(); this.display.input.focus();},\n\n    setOption: function(option, value) {\n      var options = this.options, old = options[option];\n      if (options[option] == value && option != \"mode\") return;\n      options[option] = value;\n      if (optionHandlers.hasOwnProperty(option))\n        operation(this, optionHandlers[option])(this, value, old);\n    },\n\n    getOption: function(option) {return this.options[option];},\n    getDoc: function() {return this.doc;},\n\n    addKeyMap: function(map, bottom) {\n      this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map));\n    },\n    removeKeyMap: function(map) {\n      var maps = this.state.keyMaps;\n      for (var i = 0; i < maps.length; ++i)\n        if (maps[i] == map || maps[i].name == map) {\n          maps.splice(i, 1);\n          return true;\n        }\n    },\n\n    addOverlay: methodOp(function(spec, options) {\n      var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n      if (mode.startState) throw new Error(\"Overlays may not be stateful.\");\n      this.state.overlays.push({mode: mode, modeSpec: spec, opaque: options && options.opaque});\n      this.state.modeGen++;\n      regChange(this);\n    }),\n    removeOverlay: methodOp(function(spec) {\n      var overlays = this.state.overlays;\n      for (var i = 0; i < overlays.length; ++i) {\n        var cur = overlays[i].modeSpec;\n        if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n          overlays.splice(i, 1);\n          this.state.modeGen++;\n          regChange(this);\n          return;\n        }\n      }\n    }),\n\n    indentLine: methodOp(function(n, dir, aggressive) {\n      if (typeof dir != \"string\" && typeof dir != \"number\") {\n        if (dir == null) dir = this.options.smartIndent ? \"smart\" : \"prev\";\n        else dir = dir ? \"add\" : \"subtract\";\n      }\n      if (isLine(this.doc, n)) indentLine(this, n, dir, aggressive);\n    }),\n    indentSelection: methodOp(function(how) {\n      var ranges = this.doc.sel.ranges, end = -1;\n      for (var i = 0; i < ranges.length; i++) {\n        var range = ranges[i];\n        if (!range.empty()) {\n          var from = range.from(), to = range.to();\n          var start = Math.max(end, from.line);\n          end = Math.min(this.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n          for (var j = start; j < end; ++j)\n            indentLine(this, j, how);\n          var newRanges = this.doc.sel.ranges;\n          if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\n            replaceOneSelection(this.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll);\n        } else if (range.head.line > end) {\n          indentLine(this, range.head.line, how, true);\n          end = range.head.line;\n          if (i == this.doc.sel.primIndex) ensureCursorVisible(this);\n        }\n      }\n    }),\n\n    // Fetch the parser token for a given character. Useful for hacks\n    // that want to inspect the mode state (say, for completion).\n    getTokenAt: function(pos, precise) {\n      return takeToken(this, pos, precise);\n    },\n\n    getLineTokens: function(line, precise) {\n      return takeToken(this, Pos(line), precise, true);\n    },\n\n    getTokenTypeAt: function(pos) {\n      pos = clipPos(this.doc, pos);\n      var styles = getLineStyles(this, getLine(this.doc, pos.line));\n      var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\n      var type;\n      if (ch == 0) type = styles[2];\n      else for (;;) {\n        var mid = (before + after) >> 1;\n        if ((mid ? styles[mid * 2 - 1] : 0) >= ch) after = mid;\n        else if (styles[mid * 2 + 1] < ch) before = mid + 1;\n        else { type = styles[mid * 2 + 2]; break; }\n      }\n      var cut = type ? type.indexOf(\"cm-overlay \") : -1;\n      return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1);\n    },\n\n    getModeAt: function(pos) {\n      var mode = this.doc.mode;\n      if (!mode.innerMode) return mode;\n      return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode;\n    },\n\n    getHelper: function(pos, type) {\n      return this.getHelpers(pos, type)[0];\n    },\n\n    getHelpers: function(pos, type) {\n      var found = [];\n      if (!helpers.hasOwnProperty(type)) return found;\n      var help = helpers[type], mode = this.getModeAt(pos);\n      if (typeof mode[type] == \"string\") {\n        if (help[mode[type]]) found.push(help[mode[type]]);\n      } else if (mode[type]) {\n        for (var i = 0; i < mode[type].length; i++) {\n          var val = help[mode[type][i]];\n          if (val) found.push(val);\n        }\n      } else if (mode.helperType && help[mode.helperType]) {\n        found.push(help[mode.helperType]);\n      } else if (help[mode.name]) {\n        found.push(help[mode.name]);\n      }\n      for (var i = 0; i < help._global.length; i++) {\n        var cur = help._global[i];\n        if (cur.pred(mode, this) && indexOf(found, cur.val) == -1)\n          found.push(cur.val);\n      }\n      return found;\n    },\n\n    getStateAfter: function(line, precise) {\n      var doc = this.doc;\n      line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\n      return getStateBefore(this, line + 1, precise);\n    },\n\n    cursorCoords: function(start, mode) {\n      var pos, range = this.doc.sel.primary();\n      if (start == null) pos = range.head;\n      else if (typeof start == \"object\") pos = clipPos(this.doc, start);\n      else pos = start ? range.from() : range.to();\n      return cursorCoords(this, pos, mode || \"page\");\n    },\n\n    charCoords: function(pos, mode) {\n      return charCoords(this, clipPos(this.doc, pos), mode || \"page\");\n    },\n\n    coordsChar: function(coords, mode) {\n      coords = fromCoordSystem(this, coords, mode || \"page\");\n      return coordsChar(this, coords.left, coords.top);\n    },\n\n    lineAtHeight: function(height, mode) {\n      height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top;\n      return lineAtHeight(this.doc, height + this.display.viewOffset);\n    },\n    heightAtLine: function(line, mode) {\n      var end = false, lineObj;\n      if (typeof line == \"number\") {\n        var last = this.doc.first + this.doc.size - 1;\n        if (line < this.doc.first) line = this.doc.first;\n        else if (line > last) { line = last; end = true; }\n        lineObj = getLine(this.doc, line);\n      } else {\n        lineObj = line;\n      }\n      return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || \"page\").top +\n        (end ? this.doc.height - heightAtLine(lineObj) : 0);\n    },\n\n    defaultTextHeight: function() { return textHeight(this.display); },\n    defaultCharWidth: function() { return charWidth(this.display); },\n\n    setGutterMarker: methodOp(function(line, gutterID, value) {\n      return this.doc.changeLine(line, \"gutter\", function(line) {\n        var markers = line.gutterMarkers || (line.gutterMarkers = {});\n        markers[gutterID] = value;\n        if (!value && isEmpty(markers)) line.gutterMarkers = null;\n        return true;\n      });\n    }),\n\n    clearGutter: methodOp(function(gutterID) {\n      var cm = this, doc = cm.doc, i = doc.first;\n      doc.iter(function(line) {\n        if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n          line.gutterMarkers[gutterID] = null;\n          regLineChange(cm, i, \"gutter\");\n          if (isEmpty(line.gutterMarkers)) line.gutterMarkers = null;\n        }\n        ++i;\n      });\n    }),\n\n    lineInfo: function(line) {\n      if (typeof line == \"number\") {\n        if (!isLine(this.doc, line)) return null;\n        var n = line;\n        line = getLine(this.doc, line);\n        if (!line) return null;\n      } else {\n        var n = lineNo(line);\n        if (n == null) return null;\n      }\n      return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\n              textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\n              widgets: line.widgets};\n    },\n\n    getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo};},\n\n    addWidget: function(pos, node, scroll, vert, horiz) {\n      var display = this.display;\n      pos = cursorCoords(this, clipPos(this.doc, pos));\n      var top = pos.bottom, left = pos.left;\n      node.style.position = \"absolute\";\n      node.setAttribute(\"cm-ignore-events\", \"true\");\n      this.display.input.setUneditable(node);\n      display.sizer.appendChild(node);\n      if (vert == \"over\") {\n        top = pos.top;\n      } else if (vert == \"above\" || vert == \"near\") {\n        var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n        hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\n        // Default to positioning above (if specified and possible); otherwise default to positioning below\n        if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\n          top = pos.top - node.offsetHeight;\n        else if (pos.bottom + node.offsetHeight <= vspace)\n          top = pos.bottom;\n        if (left + node.offsetWidth > hspace)\n          left = hspace - node.offsetWidth;\n      }\n      node.style.top = top + \"px\";\n      node.style.left = node.style.right = \"\";\n      if (horiz == \"right\") {\n        left = display.sizer.clientWidth - node.offsetWidth;\n        node.style.right = \"0px\";\n      } else {\n        if (horiz == \"left\") left = 0;\n        else if (horiz == \"middle\") left = (display.sizer.clientWidth - node.offsetWidth) / 2;\n        node.style.left = left + \"px\";\n      }\n      if (scroll)\n        scrollIntoView(this, left, top, left + node.offsetWidth, top + node.offsetHeight);\n    },\n\n    triggerOnKeyDown: methodOp(onKeyDown),\n    triggerOnKeyPress: methodOp(onKeyPress),\n    triggerOnKeyUp: onKeyUp,\n\n    execCommand: function(cmd) {\n      if (commands.hasOwnProperty(cmd))\n        return commands[cmd].call(null, this);\n    },\n\n    triggerElectric: methodOp(function(text) { triggerElectric(this, text); }),\n\n    findPosH: function(from, amount, unit, visually) {\n      var dir = 1;\n      if (amount < 0) { dir = -1; amount = -amount; }\n      for (var i = 0, cur = clipPos(this.doc, from); i < amount; ++i) {\n        cur = findPosH(this.doc, cur, dir, unit, visually);\n        if (cur.hitSide) break;\n      }\n      return cur;\n    },\n\n    moveH: methodOp(function(dir, unit) {\n      var cm = this;\n      cm.extendSelectionsBy(function(range) {\n        if (cm.display.shift || cm.doc.extend || range.empty())\n          return findPosH(cm.doc, range.head, dir, unit, cm.options.rtlMoveVisually);\n        else\n          return dir < 0 ? range.from() : range.to();\n      }, sel_move);\n    }),\n\n    deleteH: methodOp(function(dir, unit) {\n      var sel = this.doc.sel, doc = this.doc;\n      if (sel.somethingSelected())\n        doc.replaceSelection(\"\", null, \"+delete\");\n      else\n        deleteNearSelection(this, function(range) {\n          var other = findPosH(doc, range.head, dir, unit, false);\n          return dir < 0 ? {from: other, to: range.head} : {from: range.head, to: other};\n        });\n    }),\n\n    findPosV: function(from, amount, unit, goalColumn) {\n      var dir = 1, x = goalColumn;\n      if (amount < 0) { dir = -1; amount = -amount; }\n      for (var i = 0, cur = clipPos(this.doc, from); i < amount; ++i) {\n        var coords = cursorCoords(this, cur, \"div\");\n        if (x == null) x = coords.left;\n        else coords.left = x;\n        cur = findPosV(this, coords, dir, unit);\n        if (cur.hitSide) break;\n      }\n      return cur;\n    },\n\n    moveV: methodOp(function(dir, unit) {\n      var cm = this, doc = this.doc, goals = [];\n      var collapse = !cm.display.shift && !doc.extend && doc.sel.somethingSelected();\n      doc.extendSelectionsBy(function(range) {\n        if (collapse)\n          return dir < 0 ? range.from() : range.to();\n        var headPos = cursorCoords(cm, range.head, \"div\");\n        if (range.goalColumn != null) headPos.left = range.goalColumn;\n        goals.push(headPos.left);\n        var pos = findPosV(cm, headPos, dir, unit);\n        if (unit == \"page\" && range == doc.sel.primary())\n          addToScrollPos(cm, null, charCoords(cm, pos, \"div\").top - headPos.top);\n        return pos;\n      }, sel_move);\n      if (goals.length) for (var i = 0; i < doc.sel.ranges.length; i++)\n        doc.sel.ranges[i].goalColumn = goals[i];\n    }),\n\n    // Find the word at the given position (as returned by coordsChar).\n    findWordAt: function(pos) {\n      var doc = this.doc, line = getLine(doc, pos.line).text;\n      var start = pos.ch, end = pos.ch;\n      if (line) {\n        var helper = this.getHelper(pos, \"wordChars\");\n        if ((pos.xRel < 0 || end == line.length) && start) --start; else ++end;\n        var startChar = line.charAt(start);\n        var check = isWordChar(startChar, helper)\n          ? function(ch) { return isWordChar(ch, helper); }\n          : /\\s/.test(startChar) ? function(ch) {return /\\s/.test(ch);}\n          : function(ch) {return !/\\s/.test(ch) && !isWordChar(ch);};\n        while (start > 0 && check(line.charAt(start - 1))) --start;\n        while (end < line.length && check(line.charAt(end))) ++end;\n      }\n      return new Range(Pos(pos.line, start), Pos(pos.line, end));\n    },\n\n    toggleOverwrite: function(value) {\n      if (value != null && value == this.state.overwrite) return;\n      if (this.state.overwrite = !this.state.overwrite)\n        addClass(this.display.cursorDiv, \"CodeMirror-overwrite\");\n      else\n        rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\");\n\n      signal(this, \"overwriteToggle\", this, this.state.overwrite);\n    },\n    hasFocus: function() { return this.display.input.getField() == activeElt(); },\n    isReadOnly: function() { return !!(this.options.readOnly || this.doc.cantEdit); },\n\n    scrollTo: methodOp(function(x, y) {\n      if (x != null || y != null) resolveScrollToPos(this);\n      if (x != null) this.curOp.scrollLeft = x;\n      if (y != null) this.curOp.scrollTop = y;\n    }),\n    getScrollInfo: function() {\n      var scroller = this.display.scroller;\n      return {left: scroller.scrollLeft, top: scroller.scrollTop,\n              height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\n              width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\n              clientHeight: displayHeight(this), clientWidth: displayWidth(this)};\n    },\n\n    scrollIntoView: methodOp(function(range, margin) {\n      if (range == null) {\n        range = {from: this.doc.sel.primary().head, to: null};\n        if (margin == null) margin = this.options.cursorScrollMargin;\n      } else if (typeof range == \"number\") {\n        range = {from: Pos(range, 0), to: null};\n      } else if (range.from == null) {\n        range = {from: range, to: null};\n      }\n      if (!range.to) range.to = range.from;\n      range.margin = margin || 0;\n\n      if (range.from.line != null) {\n        resolveScrollToPos(this);\n        this.curOp.scrollToPos = range;\n      } else {\n        var sPos = calculateScrollPos(this, Math.min(range.from.left, range.to.left),\n                                      Math.min(range.from.top, range.to.top) - range.margin,\n                                      Math.max(range.from.right, range.to.right),\n                                      Math.max(range.from.bottom, range.to.bottom) + range.margin);\n        this.scrollTo(sPos.scrollLeft, sPos.scrollTop);\n      }\n    }),\n\n    setSize: methodOp(function(width, height) {\n      var cm = this;\n      function interpret(val) {\n        return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val;\n      }\n      if (width != null) cm.display.wrapper.style.width = interpret(width);\n      if (height != null) cm.display.wrapper.style.height = interpret(height);\n      if (cm.options.lineWrapping) clearLineMeasurementCache(this);\n      var lineNo = cm.display.viewFrom;\n      cm.doc.iter(lineNo, cm.display.viewTo, function(line) {\n        if (line.widgets) for (var i = 0; i < line.widgets.length; i++)\n          if (line.widgets[i].noHScroll) { regLineChange(cm, lineNo, \"widget\"); break; }\n        ++lineNo;\n      });\n      cm.curOp.forceUpdate = true;\n      signal(cm, \"refresh\", this);\n    }),\n\n    operation: function(f){return runInOp(this, f);},\n\n    refresh: methodOp(function() {\n      var oldHeight = this.display.cachedTextHeight;\n      regChange(this);\n      this.curOp.forceUpdate = true;\n      clearCaches(this);\n      this.scrollTo(this.doc.scrollLeft, this.doc.scrollTop);\n      updateGutterSpace(this);\n      if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5)\n        estimateLineHeights(this);\n      signal(this, \"refresh\", this);\n    }),\n\n    swapDoc: methodOp(function(doc) {\n      var old = this.doc;\n      old.cm = null;\n      attachDoc(this, doc);\n      clearCaches(this);\n      this.display.input.reset();\n      this.scrollTo(doc.scrollLeft, doc.scrollTop);\n      this.curOp.forceScroll = true;\n      signalLater(this, \"swapDoc\", this, old);\n      return old;\n    }),\n\n    getInputField: function(){return this.display.input.getField();},\n    getWrapperElement: function(){return this.display.wrapper;},\n    getScrollerElement: function(){return this.display.scroller;},\n    getGutterElement: function(){return this.display.gutters;}\n  };\n  eventMixin(CodeMirror);\n\n  // options.js\n\n  // models.js\n\n  // edit/commands.js\n  \n  // input/keymap.js\n\n\n  // edit/fromTextArea.js\n\n  // skylark-utils-text/StringSteam.js\n\n\n\n   // skylark-utils-text/mark_text.js\n\n   // line/spans.js\n\n\n   // line/ LineWidget.js\n\n  // LINE WIDGETS\n\n\n  // LINE DATA STRUCTURE\n\n  \n  // utils_line.js\n\n\n  // skylark-utils-text/history\n\n\n  // event.js\n  // misc.js\n\n  // edit/global_event.js\n\n  // util/feature_detection.js\n\n  // input/keynames.js\n\n  // util/bidi.js\n\n  CodeMirror.version = \"5.17.1\";\n\n  return CodeMirror;\n  \n});\n\n"]}