{"version":3,"sources":["primitives/edit/deleteNearSelection.js"],"names":["define","CoderCtor","partial","deleteNearSelection","cm","compute","this","ranges","doc","sel","kill","i","length","toKill","cmp","from","lst","to","replaced","pop","push","runInOp","replaceRange","ensureCursorVisible"],"mappings":";;;;;;;AAAAA,QACE,gBACA,SAASC,GACTA,EAAUC,SAGRC,oBAAsB,SAAUC,EAAIC,GAMlC,IAAK,GALDD,GAAKE,KAELC,EAASH,EAAGI,IAAIC,IAAIF,OAAQG,KAGvBC,EAAI,EAAGA,EAAIJ,EAAOK,OAAQD,IAAK,CAEtC,IADA,GAAIE,GAASR,EAAQE,EAAOI,IACrBD,EAAKE,QAAUE,IAAID,EAAOE,KAAMC,IAAIN,GAAMO,KAAO,GAAG,CACzD,GAAIC,GAAWR,EAAKS,KACpB,IAAIL,IAAII,EAASH,KAAMF,EAAOE,MAAQ,EAAG,CACvCF,EAAOE,KAAOG,EAASH,IACvB,QAGJL,EAAKU,KAAKP,GAGZQ,QAAQjB,EAAI,WACV,IAAK,GAAIO,GAAID,EAAKE,OAAS,EAAGD,GAAK,EAAGA,IACpCW,aAAalB,EAAGI,IAAK,GAAIE,EAAKC,GAAGI,KAAML,EAAKC,GAAGM,GAAI,UACrDM,qBAAoBnB","file":"../../../primitives/edit/deleteNearSelection.js","sourcesContent":["define([\r\n  \"../CoderCtor\"\r\n],function(CoderCtor) {\r\n  CoderCtor.partial({\r\n    // Helper for deleting text near the selection(s), used to implement\r\n    // backspace, delete, and similar functionality.\r\n    deleteNearSelection : function (cm, compute) {\r\n      var cm = this;\r\n      \r\n      var ranges = cm.doc.sel.ranges, kill = [];\r\n      // Build up a set of ranges to kill first, merging overlapping\r\n      // ranges.\r\n      for (var i = 0; i < ranges.length; i++) {\r\n        var toKill = compute(ranges[i]);\r\n        while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\r\n          var replaced = kill.pop();\r\n          if (cmp(replaced.from, toKill.from) < 0) {\r\n            toKill.from = replaced.from;\r\n            break;\r\n          }\r\n        }\r\n        kill.push(toKill);\r\n      }\r\n      // Next, remove those actual ranges.\r\n      runInOp(cm, function() {\r\n        for (var i = kill.length - 1; i >= 0; i--)\r\n          replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\");\r\n        ensureCursorVisible(cm);\r\n      });\r\n    }\r\n  });\r\n\r\n});\r\n"]}