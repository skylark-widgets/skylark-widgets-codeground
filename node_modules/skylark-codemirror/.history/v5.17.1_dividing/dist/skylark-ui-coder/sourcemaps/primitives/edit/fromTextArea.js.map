{"version":3,"sources":["primitives/edit/fromTextArea.js"],"names":["define","CoderCtor","CodeMirror","fromTextArea","textarea","options","save","value","cm","getValue","copyObj","tabindex","tabIndex","placeholder","autofocus","hasFocus","activeElt","getAttribute","document","body","form","on","leaveSubmitMethodAlone","realSubmit","submit","wrappedSubmit","e","finishInit","getTextArea","toTextArea","isNaN","parentNode","removeChild","getWrapperElement","style","display","off","node","insertBefore","nextSibling"],"mappings":";;;;;;;AAAAA,QACE,gBACA,SAASC,GAGTC,WAAWC,aAAe,SAASC,EAAUC,GAe3C,QAASC,KAAQF,EAASG,MAAQC,EAAGC,WANrC,GARAJ,EAAUA,EAAUK,QAAQL,MAC5BA,EAAQE,MAAQH,EAASG,OACpBF,EAAQM,UAAYP,EAASQ,WAChCP,EAAQM,SAAWP,EAASQ,WACzBP,EAAQQ,aAAeT,EAASS,cACnCR,EAAQQ,YAAcT,EAASS,aAGR,MAArBR,EAAQS,UAAmB,CAC7B,GAAIC,GAAWC,WACfX,GAAQS,UAAYC,GAAYX,GACQ,MAAtCA,EAASa,aAAa,cAAwBF,GAAYG,SAASC,KAIvE,GAAIf,EAASgB,OACXC,GAAGjB,EAASgB,KAAM,SAAUd,IAEvBD,EAAQiB,wBAAwB,CACnC,GAAIF,GAAOhB,EAASgB,KAAMG,EAAaH,EAAKI,MAC5C,KACE,GAAIC,GAAgBL,EAAKI,OAAS,WAChClB,IACAc,EAAKI,OAASD,EACdH,EAAKI,SACLJ,EAAKI,OAASC,GAEhB,MAAMC,KAIZrB,EAAQsB,WAAa,SAASnB,GAC5BA,EAAGF,KAAOA,EACVE,EAAGoB,YAAc,WAAa,MAAOxB,IACrCI,EAAGqB,WAAa,WACdrB,EAAGqB,WAAaC,MAChBxB,IACAF,EAAS2B,WAAWC,YAAYxB,EAAGyB,qBACnC7B,EAAS8B,MAAMC,QAAU,GACrB/B,EAASgB,OACXgB,IAAIhC,EAASgB,KAAM,SAAUd,GACM,kBAAxBF,GAASgB,KAAKI,SACvBpB,EAASgB,KAAKI,OAASD,MAK/BnB,EAAS8B,MAAMC,QAAU,MACzB,IAAI3B,GAAKN,WAAW,SAASmC,GAC3BjC,EAAS2B,WAAWO,aAAaD,EAAMjC,EAASmC,cAC/ClC,EAEH,OAAOG","file":"../../../primitives/edit/fromTextArea.js","sourcesContent":["define([\r\n  \"../CoderCtor\"\r\n],function(CoderCtor) {\r\n  // FROMTEXTAREA\r\n\r\n  CodeMirror.fromTextArea = function(textarea, options) {\r\n    options = options ? copyObj(options) : {};\r\n    options.value = textarea.value;\r\n    if (!options.tabindex && textarea.tabIndex)\r\n      options.tabindex = textarea.tabIndex;\r\n    if (!options.placeholder && textarea.placeholder)\r\n      options.placeholder = textarea.placeholder;\r\n    // Set autofocus to true if this textarea is focused, or if it has\r\n    // autofocus and no other element is focused.\r\n    if (options.autofocus == null) {\r\n      var hasFocus = activeElt();\r\n      options.autofocus = hasFocus == textarea ||\r\n        textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\r\n    }\r\n\r\n    function save() {textarea.value = cm.getValue();}\r\n    if (textarea.form) {\r\n      on(textarea.form, \"submit\", save);\r\n      // Deplorable hack to make the submit method do the right thing.\r\n      if (!options.leaveSubmitMethodAlone) {\r\n        var form = textarea.form, realSubmit = form.submit;\r\n        try {\r\n          var wrappedSubmit = form.submit = function() {\r\n            save();\r\n            form.submit = realSubmit;\r\n            form.submit();\r\n            form.submit = wrappedSubmit;\r\n          };\r\n        } catch(e) {}\r\n      }\r\n    }\r\n\r\n    options.finishInit = function(cm) {\r\n      cm.save = save;\r\n      cm.getTextArea = function() { return textarea; };\r\n      cm.toTextArea = function() {\r\n        cm.toTextArea = isNaN; // Prevent this from being ran twice\r\n        save();\r\n        textarea.parentNode.removeChild(cm.getWrapperElement());\r\n        textarea.style.display = \"\";\r\n        if (textarea.form) {\r\n          off(textarea.form, \"submit\", save);\r\n          if (typeof textarea.form.submit == \"function\")\r\n            textarea.form.submit = realSubmit;\r\n        }\r\n      };\r\n    };\r\n\r\n    textarea.style.display = \"none\";\r\n    var cm = CodeMirror(function(node) {\r\n      textarea.parentNode.insertBefore(node, textarea.nextSibling);\r\n    }, options);\r\n    \r\n    return cm;\r\n  };\r\n\r\n\r\n});\r\n"]}